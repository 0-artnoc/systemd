#! /bin/sh
#
# test.block - run udev(8) on each block device in /sys/block

SYSFSDIR=/sys		# change this for a nonstand sysfs mount point
BIN=./udev		# location of your udev binary
export ACTION=add	# 'add' or 'remove'

for i in ${SYSFSDIR}/block/*; do
	# add each drive
	export DEVPATH="/"`echo $i | cut --delimiter='/' --fields=3-`
	$BIN block

	# add each partition, on each device
	for j in $i/*; do
		if [ -f $j/dev ]; then
			export DEVPATH="/"`echo $j |  \
				cut --delimiter='/' --fields=3-`
			$BIN block
		fi
	done
done
